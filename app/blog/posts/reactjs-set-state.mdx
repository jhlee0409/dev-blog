---
title: "setState íŒŒí—¤ì¹˜ê¸°"
publishedAt: "2022-11-16"
updatedAt: "2024-12-12"
summary: "setState íŒŒí—¤ì¹˜ê¸°"
tags: "react, setState, hook"
---

## ì„œë¡ 

- `React`ë¥¼ ì‚¬ìš©í•˜ê²Œ ë˜ë©´ `state`ë¥¼ ì—…ë°ì´íŠ¸ í•´ì•¼í•˜ëŠ” ìƒí™©ì´ ì˜¨ë‹¤.
- `state`ë¥¼ ì—…ë°ì´íŠ¸í•  ë•Œ ì‚¬ìš©í•˜ëŠ” `useState`ì˜ `setState`ì— ëŒ€í•´ ì•Œì•„ë³´ì.
- `setState`ë¥¼ ì‚¬ìš©í• ë•Œ í•¨ìˆ˜ë¥¼ ë„£ëŠ” ê²½ìš°ì™€ ê°’ì„ ì§ì ‘ ë„£ëŠ” ê²½ìš°ë¥¼ ë³¸ ì ì´ ìˆì„ ê²ƒì´ë‹¤.
- ê°ê°ì˜ ê²½ìš°ê°€ ì–´ë– í•œ ë°©ì‹ìœ¼ë¡œ ì‹¤í–‰ë˜ê³  ì°¨ì´ì ì€ ë¬´ì—‡ì¼ê¹Œ?
- `setState`ê°€ ë¬´ì—‡ì¸ì§€ ê·¸ë¦¬ê³  ì–´ë– í•œ ë°©ì‹ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ”ì§€ ì•Œì•„ë³´ì

## setState

- `React`ë¥¼ ì“°ë©´ì„œ ê°€ì¥ ë§ì´ ì“°ëŠ” ë©”ì†Œë“œì´ë‹¤.
- `useState` í›…ì—ì„œ í˜¸ì¶œí•˜ëŠ” ë©”ì†Œë“œ ì´ë‹¤.
- `state`ì˜ ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•´ ì‚¬ìš©ëœë‹¤.
- `state`ë¥¼ ì—…ë°ì´íŠ¸í•˜ë©´ `ë¦¬ëœë”ë§`ì´ ì¼ì–´ë‚œë‹¤.
- `ë¹„ë™ê¸°ì `ìœ¼ë¡œ ë™ì‘í•œë‹¤.

## ì‚¬ìš©ë²•

### 1. updater í•¨ìˆ˜ë¥¼ ì´ìš©í•œ ë°©ì‹ (ê¶Œì¥)

- í˜•íƒœ
- ì´ì „ ìƒíƒœê°’ì„ ì•ˆì „í•˜ê²Œ ì°¸ì¡°í•  ìˆ˜ ìˆì–´ ì—°ì†ì ì¸ ì—…ë°ì´íŠ¸ì— ì í•©í•˜ë‹¤.

```jsx
const [state, setState] = useState(0);

setState((prev) => prev + 1);
```

### 2. state ê°’ì„ ì´ìš©í•œ ë°©ì‹

- í˜•íƒœ
- ë‹¨ìˆœí•œ ìƒíƒœ ì—…ë°ì´íŠ¸ì— ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ, ì—°ì†ì ì¸ ì—…ë°ì´íŠ¸ì‹œ ì£¼ì˜ê°€ í•„ìš”í•˜ë‹¤.

```jsx
const [state, setState] = useState(0);

setState(state + 1);
```

## ì°¨ì´ì 

- ê°€ì¥ í° ì°¨ì´ì ì€ `state`ë³€ê²½ ì‹œ ì´ì „ ê°’ì˜ ë³´ì¥ ìœ ë¬´ì´ë‹¤.
- ì´ê²Œ ë¬´ìŠ¨ ë§ì´ëƒ? ì˜ˆì œë¥¼ ë³´ì
- ìœ„ì™€ ë˜‘ê°™ì´ `state`ë¥¼ 1ì”© ì¦ê°€ì‹œí‚¤ëŠ” í•¨ìˆ˜ê°€ ìˆë‹¤ê³  ê°€ì •í•˜ì
- `setState`ëŠ” ë˜‘ê°™ì´ 1ì”© ì¦ê°€ì‹œí‚¨ë‹¤. ê·¸ë ‡ë‹¤ë©´ `setState`ë¥¼ ë‘ë²ˆ ì‹¤í–‰ì‹œí‚¤ëŠ” `increase1`, `increase2`ì—ì„œ ê°’ì´ ë™ì¼í•˜ê²Œ 2ì”© ëŠ˜ì–´ë‚ ê¹Œ?

```jsx
const [state, setState] = useState(0);

const increase1 = () => {
  setState((prev) => prev + 1);
  setState((prev) => prev + 1);
};
// result +2 per click

const increase2 = () => {
  setState(state + 1);
  setState(state + 1);
};
// result +1 per click
```

### ê²°ê³¼

- `increase1` = +2 ì¦ê°€í•˜ê³ , `increase2` = +1 ì¦ê°€í•œë‹¤.

### Why?

- ë°”ë¡œ `setState`ëŠ” `ë¹„ë™ê¸°ì `ìœ¼ë¡œ ë™ì‘í•˜ê¸° ë•Œë¬¸ì´ë‹¤.
- `setState`ëŠ” í˜¸ì¶œ ì¦‰ì‹œ ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤.
- `React`ì—ì„œëŠ” íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ì„œ `state`ë¥¼ ë³€ê²½í•˜ê² ë‹¤ê³  ëŒ€ê¸°ì—´ì— ì¶”ê°€í•œ ë’¤, ì—¬ëŸ¬ ë³€ê²½ ì‚¬í•­ë“¤ê³¼ `ë¬¶ì–´ì„œ í•œë²ˆì— ì—…ë°ì´íŠ¸` í•œë‹¤.
- ê·¸ë ‡ê¸° ë•Œë¬¸ì— `increase2`ì˜ ê²½ìš° `setState`ë¥¼ 2ë²ˆ í˜¸ì¶œí•˜ì§€ë§Œ í•œêº¼ë²ˆì— ë¬¶ì–´ì„œ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— +1ì”© ì¦ê°€í•˜ëŠ” ê²ƒì´ë‹¤.
- í•¨ìˆ˜ë¥¼ ì´ìš©í•œ ë°©ì‹ì€ `setState`ê°€ `state`ë¥¼ ë³€ê²½í•˜ëŠ” ì‹œì ì— ì´ì „ ê°’ì„ ì°¸ì¡°í•˜ê¸° ë•Œë¬¸ì— +2ì”© ì¦ê°€í•œë‹¤.
- ì´ëŸ¬í•œ ì´ìœ ë¡œ ì—°ì†ì ì¸ ìƒíƒœ ì—…ë°ì´íŠ¸ê°€ í•„ìš”í•œ ê²½ìš° updater í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì•ˆì „í•˜ë‹¤.

## React 18ì˜ Automatic Batching

- `React 18`ë¶€í„°ëŠ” `ìë™ ë°°ì¹­(Automatic Batching)`ì´ ë„ì…ë˜ì—ˆë‹¤.
- ë‹¨, `createRoot`ë¥¼ ì‚¬ìš©í•  ë•Œë§Œ ì ìš©ëœë‹¤.
- ì´ì „ì—ëŠ” `React` ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë‚´ë¶€ì—ì„œë§Œ ë°°ì¹­ì´ ë°œìƒí–ˆë‹¤.
- ì´ì œëŠ” `Promise`, `setTimeout`, `ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬` ë“± ëª¨ë“  ê³³ì—ì„œ ë°°ì¹­ì´ ë°œìƒí•œë‹¤.
- ë°°ì¹­ì€ ì—¬ëŸ¬ ìƒíƒœ ì—…ë°ì´íŠ¸ë¥¼ í•˜ë‚˜ì˜ ë¦¬ë Œë”ë§ìœ¼ë¡œ ë¬¶ì–´ì„œ ì²˜ë¦¬í•¨ìœ¼ë¡œì¨ ì„±ëŠ¥ì„ ìµœì í™”í•œë‹¤.
- ë°°ì¹­ì„ í”¼í•´ì•¼ í•˜ëŠ” ê²½ìš° `flushSync`ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- ë‹¨, `flushSync`ëŠ” ì„±ëŠ¥ì— ë¶€ì •ì ì¸ ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ê¼­ í•„ìš”í•œ ê²½ìš°ì—ë§Œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
- ì˜ˆì œë¥¼ ë³´ì

```jsx
// React 18 ì´ì „
setTimeout(() => {
  setCount((c) => c + 1); // ë¦¬ë Œë”ë§ ë°œìƒ
  setFlag((f) => !f); // ë¦¬ë Œë”ë§ ë°œìƒ
}, 1000);

// React 18
setTimeout(() => {
  setCount((c) => c + 1); // ë°°ì¹­
  setFlag((f) => !f); // ë°°ì¹­
}, 1000); // í•œë²ˆì˜ ë¦¬ë Œë”ë§

// ë°°ì¹­ í”¼í•˜ê¸° (ê¼­ í•„ìš”í•œ ê²½ìš°ì—ë§Œ ì‚¬ìš©)
import { flushSync } from "react-dom";

const handleClick = () => {
  flushSync(() => {
    setCount((c) => c + 1); // ì¦‰ì‹œ ë¦¬ë Œë”ë§
  });
  flushSync(() => {
    setFlag((f) => !f); // ì¦‰ì‹œ ë¦¬ë Œë”ë§
  });
};
```

## ê°ì²´ë‚˜ ë°°ì—´ ìƒíƒœ ë‹¤ë£¨ê¸°

- `state`ê°€ ê°ì²´ë‚˜ ë°°ì—´ì¼ ë•ŒëŠ” ë”ìš± ì£¼ì˜í•´ì•¼ í•œë‹¤.
- Reactì—ì„œ ë¶ˆë³€ì„±(Immutability)ì„ ì§€í‚¤ëŠ” ê²ƒì€ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤.
- ë¶ˆë³€ì„±ì„ ì§€ì¼œì•¼ Reactê°€ ìƒíƒœ ë³€í™”ë¥¼ ê°ì§€í•˜ê³  íš¨ìœ¨ì ìœ¼ë¡œ ë¦¬ë Œë”ë§í•  ìˆ˜ ìˆë‹¤.
- ì–•ì€ ë³µì‚¬ë¡œ ì¸í•´ ì˜ë„ì¹˜ ì•Šì€ ê²°ê³¼ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.
- ì¤‘ì²©ëœ ê°ì²´ë‚˜ ë°°ì—´ì„ ë‹¤ë£° ë•ŒëŠ” ë”ìš± ì£¼ì˜ê°€ í•„ìš”í•˜ë‹¤.
- ë³µì¡í•œ ê°ì²´ì˜ ê²½ìš° Immer ê°™ì€ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ë©´ ë¶ˆë³€ì„±ì„ ì‰½ê²Œ ìœ ì§€í•  ìˆ˜ ìˆë‹¤.
- ì˜ˆì œë¥¼ ë³´ì

```jsx
const [user, setUser] = useState({
  name: "John",
  age: 20,
  address: {
    city: "Seoul",
    street: "Gangnam",
  },
  hobbies: ["reading", "gaming"],
});

// âŒ ì˜ëª»ëœ ë°©ë²•
const updateAddress = () => {
  user.address.city = "Busan"; // ì§ì ‘ ìˆ˜ì •
  setUser(user); // ì°¸ì¡°ê°€ ê°™ì•„ì„œ ë¦¬ë Œë”ë§ ì•ˆë¨
};

const addHobby = () => {
  user.hobbies.push("coding"); // ì§ì ‘ ìˆ˜ì •
  setUser(user); // ì°¸ì¡°ê°€ ê°™ì•„ì„œ ë¦¬ë Œë”ë§ ì•ˆë¨
};

// âœ… ì˜¬ë°”ë¥¸ ë°©ë²•
const updateAddress = () => {
  setUser((prev) => ({
    ...prev,
    address: {
      ...prev.address,
      city: "Busan",
    },
  }));
};

const addHobby = () => {
  setUser((prev) => ({
    ...prev,
    hobbies: [...prev.hobbies, "coding"],
  }));
};

// âœ… Immerë¥¼ ì‚¬ìš©í•œ ë°©ë²•
import produce from "immer";

const updateAddressWithImmer = () => {
  setUser(
    produce((draft) => {
      draft.address.city = "Busan";
    })
  );
};
```

## ì—¬ëŸ¬ ìƒíƒœ ë™ì‹œì— ì—…ë°ì´íŠ¸í•˜ê¸°

- ì—¬ëŸ¬ ìƒíƒœë¥¼ í•œë²ˆì— ì—…ë°ì´íŠ¸ í•´ì•¼í•  ë•Œê°€ ìˆë‹¤.
- ì´ëŸ´ ë•ŒëŠ” `useReducer`ë¥¼ ê³ ë ¤í•´ë³´ëŠ” ê²ƒì´ ì¢‹ë‹¤.
- useReducerëŠ” ë‹¤ìŒê³¼ ê°™ì€ ê²½ìš°ì— íŠ¹íˆ ìœ ìš©í•˜ë‹¤:
  - ì—¬ëŸ¬ ìƒíƒœê°€ ì„œë¡œ ì—°ê´€ë˜ì–´ ìˆì„ ë•Œ
  - ë‹¤ìŒ ìƒíƒœê°€ ì´ì „ ìƒíƒœì— ì˜ì¡´ì ì¼ ë•Œ
  - ìƒíƒœ ì—…ë°ì´íŠ¸ ë¡œì§ì´ ë³µì¡í•  ë•Œ
- ì˜ˆì œë¥¼ ë³´ì

```jsx
// ì—¬ëŸ¬ ìƒíƒœë¥¼ ê°œë³„ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸
const updateUserInfo = () => {
  setName("John");
  setAge(25);
  setEmail("john@example.com");
};

// useReducerë¥¼ ì‚¬ìš©í•œ ë°©ë²•
const reducer = (state, action) => {
  switch (action.type) {
    case "UPDATE_USER":
      return {
        ...state,
        name: action.payload.name,
        age: action.payload.age,
        email: action.payload.email,
      };
    default:
      return state;
  }
};

const updateUserInfo = () => {
  dispatch({
    type: "UPDATE_USER",
    payload: {
      name: "John",
      age: 25,
      email: "john@example.com",
    },
  });
};
```

## ì„±ëŠ¥ ìµœì í™”

- `state` ì—…ë°ì´íŠ¸ëŠ” ë¦¬ë Œë”ë§ì„ ë°œìƒì‹œí‚¤ë¯€ë¡œ ì„±ëŠ¥ì— ì˜í–¥ì„ ì¤€ë‹¤.
- ì„±ëŠ¥ ìµœì í™”ëŠ” ì‹¤ì œ ì„±ëŠ¥ ì¸¡ì • í›„ì— ì§„í–‰í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.
- React DevToolsì˜ Profilerë¥¼ ì‚¬ìš©í•´ ì„±ëŠ¥ ë³‘ëª©ì§€ì ì„ ì°¾ì•„ë³´ì.
- `useCallback`ê³¼ `useMemo`ëŠ” ì‹ ì¤‘í•˜ê²Œ ì‚¬ìš©í•´ì•¼ í•œë‹¤:
  - ì´ëŸ¬í•œ ìµœì í™”ê°€ í•­ìƒ ì„±ëŠ¥ í–¥ìƒì„ ë³´ì¥í•˜ì§€ëŠ” ì•ŠëŠ”ë‹¤.
  - ë•Œë¡œëŠ” ë¶ˆí•„ìš”í•œ ë³µì¡ì„±ë§Œ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.
  - ì‹¤ì œ ì„±ëŠ¥ ì¸¡ì • í›„ í•„ìš”í•œ ê²½ìš°ì—ë§Œ ì ìš©í•˜ì.

```jsx
// ğŸ¤” ìµœì í™”ê°€ í•„ìš”í•œì§€ ê³ ë¯¼ì´ í•„ìš”í•œ ê²½ìš°
const Component = ({ items }) => {
  const [filter, setFilter] = useState("");

  // ë§¤ ë Œë”ë§ë§ˆë‹¤ ìƒˆë¡œìš´ í•¨ìˆ˜ ìƒì„±
  const handleFilter = (value) => {
    setFilter(value);
  };

  // ë§¤ ë Œë”ë§ë§ˆë‹¤ í•„í„°ë§ ë¡œì§ì´ ì¬ì‹¤í–‰ë¨
  const filteredItems = items.filter((item) => item.name.includes(filter));

  return (
    <div>
      <input onChange={(e) => handleFilter(e.target.value)} />
      <ItemList items={filteredItems} />
    </div>
  );
};

// âœ… ì„±ëŠ¥ ì¸¡ì • í›„ ìµœì í™”ê°€ í•„ìš”í•œ ê²½ìš°
const Component = ({ items }) => {
  const [filter, setFilter] = useState("");

  // ì„±ëŠ¥ ì¸¡ì • ê²°ê³¼ ìµœì í™”ê°€ í•„ìš”í•œ ê²½ìš°ì—ë§Œ ì ìš©
  const handleFilter = useCallback((value) => {
    setFilter(value);
  }, []); // ì˜ì¡´ì„± ì—†ìŒ

  // í•„í„°ë§ ë¹„ìš©ì´ í° ê²½ìš°ì—ë§Œ ë©”ëª¨ì´ì œì´ì…˜ ì ìš©
  const filteredItems = useMemo(
    () => items.filter((item) => item.name.includes(filter)),
    [items, filter] // itemsë‚˜ filterê°€ ë³€ê²½ë  ë•Œë§Œ ì¬ê³„ì‚°
  );

  return (
    <div>
      <input onChange={(e) => handleFilter(e.target.value)} />
      <ItemList items={filteredItems} />
    </div>
  );
};
```

## ë§ˆë¬´ë¦¬

- setStateëŠ” Reactì—ì„œ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ëŠ” í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜ì´ë‹¤.
- ìƒíƒœ ì—…ë°ì´íŠ¸ì‹œ updater í•¨ìˆ˜ ì‚¬ìš©ì„ ê¶Œì¥í•œë‹¤.
- ë¶ˆë³€ì„±ì„ ì§€í‚¤ëŠ” ê²ƒì´ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤.
- ì„±ëŠ¥ ìµœì í™”ëŠ” ì‹¤ì œ ì¸¡ì • í›„ ì ìš©í•˜ì.
- React 18ì˜ Automatic Batchingì„ í™œìš©í•˜ë©´ ë” ë‚˜ì€ ì„±ëŠ¥ì„ ì–»ì„ ìˆ˜ ìˆë‹¤.

## ì°¸ì¡°

- [React ê³µì‹ë¬¸ì„œ](https://react.dev/blog/2023/03/16/introducing-react-dev)
- [React 18 Release Notes](https://react.dev/blog/2022/03/29/react-v18)

**í”¼ë“œë°±ì€ ì–¸ì œë‚˜ í™˜ì˜ì…ë‹ˆë‹¤.**
